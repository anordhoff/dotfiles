# ==================== settings ====================
# setw -g aggressive-resize on # useful when using a multi-monitor setup
set  -g base-index 1         # start windows at one
set  -g monitor-activity on  # highlight windows with activity in status line
set  -g bell-action none     # disable bell sound
set  -g display-time 4000    # set display time for tmux messages
set -sg escape-time 0        # no delay for escape key press
set  -g focus-events on      # focus events enabled for supported terminals
set  -g history-limit 10000  # increase scrollback buffer size
setw -g mode-keys vi         # vi for copy mode
setw -g pane-base-index 1    # start panes at one
set  -s set-clipboard on     # allow vim to access the clipboard
set  -g status-interval 5    # refresh 'status-{left,right}' every five seconds
set  -g status-keys emacs    # emacs for status line commands

# support 256 color terminals
set  -g default-terminal 'screen-256color'
# set -as terminal-features ',xterm*:RGB'

# support 16 color terminals
# set -g default-terminal 'screen-16color'

# automatically set window title (command, else current directory)
set -g automatic-rename on
set -g automatic-rename-format '#{b:pane_current_path}'

# set -g automatic-rename-format '#{?#{==:#{pane_current_command},bash},\
#{b:pane_current_path},#{pane_current_command}}'
# set-window-option -g window-status-current-format '#[fg=white,bold]** #{window_index} #[fg=green]#{pane_current_command} #[fg=blue]#(echo "#{pane_current_path}" | rev | cut -d'/' -f-3 | rev) #[fg=white]**|'
# set-window-option -g window-status-format '#[fg=white,bold]#{window_index} #[fg=green]#{pane_current_command} #[fg=blue]#(echo "#{pane_current_path}" | rev | cut -d'/' -f-3 | rev) #[fg=white]|'

# paste from clipboard
if-shell '[[ "$OSTYPE" == "linux-gnu"* ]]' {
    if-shell '[ -z "$WAYLAND_DISPLAY" ]' \
        'bind ] run "xclip -o -selection clipboard | \
            tmux load-buffer -; tmux paste-buffer"' \
        'bind ] run "wl-paste --no-newline | \
            tmux load-buffer -; tmux paste-buffer"'
}
if-shell '[[ "$OSTYPE" == "darwin"* ]]' \
    'bind ] run "reattach-to-user-namespace pbpaste | \
        tmux load-buffer -; tmux paste-buffer"'

# open windows in current working directory
bind c new-window -c "#{pane_current_path}"

# open splits in current working directory
bind % split-window -h -c '#{pane_current_path}'
bind \" split-window -v -c '#{pane_current_path}'

# warn before detaching session
bind d confirm-before -p 'detach-session #S? (y/n)' detach-client

# ==================== key bindings ====================
# rebind prefix
set -g prefix M-e
unbind C-b
bind M-e send-prefix

# previous pane
bind e select-pane -t :.-

# resize pane
bind Z command-prompt -I 'resize-pane '

# join current pane to given window
bind @ command-prompt -I 'join-pane -t :'

# move window left or right in status bar
bind < { swap-window -t -1; previous-window }
bind > { swap-window -t +1; next-window }

# ==================== style ====================
set -g status-left ' '
set -g status-right '    #S '
set -g window-status-separator '  '
set -g window-status-format '#I|#W#F'
set -g window-status-current-format '#I|#W#F'

set -g status-fg brightwhite
set -g status-bg black
set -g window-status-style          fg=white,bg=black
set -g window-status-current-style  fg=brightwhite,bg=black
set -g window-status-activity-style fg=black,bg=brightwhite
set -g pane-border-style            fg=brightblack,bg=black
set -g pane-active-border-style     fg=brightwhite,bg=black
set -g mode-style                   fg=brightwhite,bg=brightblack
set -g message-style                fg=brightwhite,bg=black
set -g message-command-style        fg=brightwhite,bg=black

# ==================== plugins ====================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# tmux-resurrect
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-nvim 'session'

# tmux-continuum
set -g @continuum-restore 'on'
set -g @continuum-boot 'off'
set -g @continuum-save-interval '15'

# initialize tmux plugin manager (keep this line at the bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
